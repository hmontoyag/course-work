0x0000000000000000: 0A 23 69 6E 63 6C 75 64 65 20 3C 73 74 64 69 6F  .#include <stdio
0x0000000000000010: 2E 68 3E 0A 23 69 6E 63 6C 75 64 65 20 3C 73 74  .h>.#include <st
0x0000000000000020: 72 69 6E 67 2E 68 3E 0A 23 69 6E 63 6C 75 64 65  ring.h>.#include
0x0000000000000030: 20 3C 73 74 64 6C 69 62 2E 68 3E 0A 0A 76 6F 69   <stdlib.h>..voi
0x0000000000000040: 64 20 66 69 6C 65 64 75 6D 70 28 63 68 61 72 20  d filedump(char 
0x0000000000000050: 2A 20 70 20 2C 20 69 6E 74 20 6C 65 6E 29 20 7B  * p , int len) {
0x0000000000000060: 0A 0A 20 20 20 20 46 49 4C 45 20 2A 20 66 69 6E  ..    FILE * fin
0x0000000000000070: 20 3D 20 66 6F 70 65 6E 28 70 2C 22 72 22 20 29   = fopen(p,"r" )
0x0000000000000080: 3B 0A 20 20 20 20 66 73 65 65 6B 28 66 69 6E 2C  ;.    fseek(fin,
0x0000000000000090: 30 4C 2C 53 45 45 4B 5F 45 4E 44 29 3B 0A 20 20  0L,SEEK_END);.  
0x00000000000000A0: 20 20 69 6E 74 20 73 69 7A 65 20 3D 20 66 74 65    int size = fte
0x00000000000000B0: 6C 6C 28 66 69 6E 29 3B 0A 20 20 20 20 66 73 65  ll(fin);.    fse
0x00000000000000C0: 65 6B 28 66 69 6E 2C 20 30 4C 2C 20 53 45 45 4B  ek(fin, 0L, SEEK
0x00000000000000D0: 5F 53 45 54 29 3B 0A 20 20 20 20 63 68 61 72 20  _SET);.    char 
0x00000000000000E0: 2A 20 70 65 20 3D 20 28 63 68 61 72 2A 29 20 6D  * pe = (char*) m
0x00000000000000F0: 61 6C 6C 6F 63 28 73 69 7A 65 6F 66 28 73 69 7A  alloc(sizeof(siz
0x0000000000000100: 65 29 29 3B 0A 20 20 20 20 2F 2A 2A 2F 20 20 66  e));.    /**/  f
0x0000000000000110: 72 65 61 64 28 70 65 2C 73 69 7A 65 6F 66 28 63  read(pe,sizeof(c
0x0000000000000120: 68 61 72 29 2C 6C 65 6E 2C 66 69 6E 29 3B 0A 20  har),len,fin);. 
0x0000000000000130: 20 20 20 0A 20 20 20 20 69 6E 74 20 69 3B 0A 20     .    int i;. 
0x0000000000000140: 20 20 20 69 6E 74 20 64 3D 30 3B 0A 20 20 20 20     int d=0;.    
0x0000000000000150: 69 6E 74 20 66 3D 30 3B 0A 20 20 20 20 69 6E 74  int f=0;.    int
0x0000000000000160: 20 63 6F 75 6E 74 20 3D 20 31 3B 0A 20 20 20 20   count = 1;.    
0x0000000000000170: 6C 6F 6E 67 20 61 20 3D 20 30 3B 0A 20 20 20 20  long a = 0;.    
0x0000000000000180: 69 66 20 28 6C 65 6E 20 3E 20 73 69 7A 65 29 20  if (len > size) 
0x0000000000000190: 7B 20 6C 65 6E 20 3D 20 73 69 7A 65 3B 7D 0A 20  { len = size;}. 
0x00000000000001A0: 20 20 2F 2F 20 70 72 69 6E 74 66 28 22 61 22 29    // printf("a")
0x00000000000001B0: 3B 0A 20 20 20 20 70 72 69 6E 74 66 28 22 30 78  ;.    printf("0x
0x00000000000001C0: 25 30 31 36 6C 58 3A 20 22 2C 20 28 75 6E 73 69  %016lX: ", (unsi
0x00000000000001D0: 67 6E 65 64 20 6C 6F 6E 67 29 20 61 29 3B 0A 20  gned long) a);. 
0x00000000000001E0: 20 20 20 66 6F 72 28 69 3D 30 3B 20 69 20 3C 6C     for(i=0; i <l
0x00000000000001F0: 65 6E 3B 20 69 2B 2B 29 20 7B 0A 20 20 20 20 20  en; i++) {.     
0x0000000000000200: 20 69 6E 74 20 63 20 3D 20 70 65 5B 69 5D 26 30   int c = pe[i]&0
0x0000000000000210: 78 46 46 3B 0A 20 20 20 20 20 20 70 72 69 6E 74  xFF;.      print
0x0000000000000220: 66 28 22 25 30 32 58 20 22 2C 63 29 3B 0A 20 20  f("%02X ",c);.  
0x0000000000000230: 20 20 20 20 69 66 28 63 6F 75 6E 74 3D 3D 31 36      if(count==16
0x0000000000000240: 7C 7C 69 2B 31 3D 3D 6C 65 6E 29 7B 0A 20 20 20  ||i+1==len){.   
0x0000000000000250: 20 20 20 20 20 69 66 28 63 6F 75 6E 74 20 21 3D       if(count !=
0x0000000000000260: 20 31 36 29 7B 0A 09 20 20 66 6F 72 28 66 20 3D   16){..  for(f =
0x0000000000000270: 20 63 6F 75 6E 74 3B 20 66 20 3C 20 31 36 3B 20   count; f < 16; 
0x0000000000000280: 66 2B 2B 29 20 7B 20 70 72 69 6E 74 66 28 22 20  f++) { printf(" 
0x0000000000000290: 20 20 22 29 3B 7D 0A 09 7D 20 20 0A 20 20 20 20    ");}..}  .    
0x00000000000002A0: 20 20 20 20 20 70 72 69 6E 74 66 28 22 20 22 29       printf(" ")
0x00000000000002B0: 3B 0A 09 20 66 6F 72 28 64 20 3D 20 69 20 2D 20  ;.. for(d = i - 
0x00000000000002C0: 63 6F 75 6E 74 2B 31 3B 20 64 3C 20 69 2B 31 3B  count+1; d< i+1;
0x00000000000002D0: 20 64 2B 2B 29 7B 0A 09 20 20 20 69 6E 74 20 63   d++){..   int c
0x00000000000002E0: 64 20 3D 20 70 65 5B 64 5D 26 30 78 46 46 3B 0A  d = pe[d]&0xFF;.
0x00000000000002F0: 09 20 20 20 70 72 69 6E 74 66 28 22 25 63 22 2C  .   printf("%c",
0x0000000000000300: 28 63 64 3E 3D 33 32 26 26 63 64 3C 31 32 37 29  (cd>=32&&cd<127)
0x0000000000000310: 3F 63 64 3A 27 2E 27 29 3B 0A 09 20 7D 0A 09 20  ?cd:'.');.. }.. 
0x0000000000000320: 70 72 69 6E 74 66 28 22 5C 6E 22 29 3B 0A 09 20  printf("\n");.. 
0x0000000000000330: 69 66 28 69 2B 31 21 3D 6C 65 6E 29 7B 0A 09 20  if(i+1!=len){.. 
0x0000000000000340: 20 20 70 72 69 6E 74 66 28 22 30 78 25 30 31 36    printf("0x%016
0x0000000000000350: 6C 58 3A 20 22 2C 28 75 6E 73 69 67 6E 65 64 20  lX: ",(unsigned 
0x0000000000000360: 6C 6F 6E 67 29 20 61 2B 28 69 2B 31 29 29 3B 0A  long) a+(i+1));.
0x0000000000000370: 09 20 7D 0A 09 20 63 6F 75 6E 74 20 3D 30 3B 0A  . }.. count =0;.
0x0000000000000380: 09 20 66 20 3D 20 69 3B 0A 20 20 20 20 20 20 20  . f = i;.       
0x0000000000000390: 7D 0A 20 20 20 20 20 20 20 63 6F 75 6E 74 2B 2B  }.       count++
0x00000000000003A0: 3B 0A 20 20 20 20 20 7D 0A 20 20 20 20 20 0A 7D  ;.     }.     .}
0x00000000000003B0: 0A 0A 69 6E 74 0A 6D 61 69 6E 28 69 6E 74 20 61  ..int.main(int a
0x00000000000003C0: 72 67 63 2C 20 63 68 61 72 20 2A 2A 61 72 67 76  rgc, char **argv
0x00000000000003D0: 29 20 7B 0A 20 20 69 66 20 28 61 72 67 63 20 3C  ) {.  if (argc <
0x00000000000003E0: 20 31 29 20 7B 20 70 72 69 6E 74 66 28 22 55 73   1) { printf("Us
0x00000000000003F0: 61 67 65 3A 20 6D 79 66 69 6C 65 64 75 6D 70 20  age: myfiledump 
0x0000000000000400: 66 69 6C 65 20 5B 6D 61 78 62 79 74 65 73 5D 5C  file [maxbytes]\
0x0000000000000410: 6E 22 29 3B 7D 0A 20 20 63 68 61 72 20 2A 20 66  n");}.  char * f
0x0000000000000420: 69 6C 65 4E 61 6D 65 20 3D 20 61 72 67 76 5B 31  ileName = argv[1
0x0000000000000430: 5D 3B 0A 20 20 46 49 4C 45 20 2A 20 66 64 20 3D  ];.  FILE * fd =
0x0000000000000440: 20 66 6F 70 65 6E 28 66 69 6C 65 4E 61 6D 65 2C   fopen(fileName,
0x0000000000000450: 22 72 22 29 3B 0A 20 20 69 66 28 66 64 20 3D 3D  "r");.  if(fd ==
0x0000000000000460: 20 4E 55 4C 4C 29 20 7B 20 0A 20 20 20 20 70 72   NULL) { .    pr
0x0000000000000470: 69 6E 74 66 28 22 45 72 72 6F 72 20 6F 70 65 6E  intf("Error open
0x0000000000000480: 69 6E 67 20 66 69 6C 65 20 5C 22 25 73 5C 22 5C  ing file \"%s\"\
0x0000000000000490: 6E 22 2C 66 69 6C 65 4E 61 6D 65 29 3B 0A 20 20  n",fileName);.  
0x00000000000004A0: 20 20 65 78 69 74 28 31 29 3B 0A 20 20 7D 0A 20    exit(1);.  }. 
0x00000000000004B0: 20 66 73 65 65 6B 28 66 64 2C 30 4C 2C 53 45 45   fseek(fd,0L,SEE
0x00000000000004C0: 4B 5F 45 4E 44 29 3B 0A 20 20 69 6E 74 20 73 69  K_END);.  int si
0x00000000000004D0: 7A 65 20 3D 20 66 74 65 6C 6C 28 66 64 29 3B 0A  ze = ftell(fd);.
0x00000000000004E0: 20 20 66 73 65 65 6B 28 66 64 2C 30 4C 2C 53 45    fseek(fd,0L,SE
0x00000000000004F0: 45 4B 5F 53 45 54 29 3B 0A 20 20 66 63 6C 6F 73  EK_SET);.  fclos
0x0000000000000500: 65 28 66 64 29 3B 0A 20 20 69 66 28 61 72 67 63  e(fd);.  if(argc
0x0000000000000510: 20 3C 20 33 29 20 7B 0A 20 20 20 20 66 69 6C 65   < 3) {.    file
0x0000000000000520: 64 75 6D 70 28 66 69 6C 65 4E 61 6D 65 2C 20 73  dump(fileName, s
0x0000000000000530: 69 7A 65 29 3B 0A 20 20 7D 20 65 6C 73 65 20 7B  ize);.  } else {
0x0000000000000540: 0A 20 20 20 20 69 6E 74 20 6C 65 6E 20 3D 20 61  .    int len = a
0x0000000000000550: 74 6F 69 28 61 72 67 76 5B 32 5D 29 3B 0A 20 20  toi(argv[2]);.  
0x0000000000000560: 20 20 66 69 6C 65 64 75 6D 70 28 66 69 6C 65 4E    filedump(fileN
0x0000000000000570: 61 6D 65 2C 6C 65 6E 29 3B 0A 20 20 20 20 7D 0A  ame,len);.    }.
0x0000000000000580: 7D 0A 0A 0A 0A                                   }....
